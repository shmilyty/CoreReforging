# 钢之魂：核心重构 Ver 0.2 - 功能说明

## 🎮 游戏特性

### 1. 装备系统

#### 武器属性
- **攻击力 (ATK)**: 基础伤害值
- **暴击率 (Crit Rate)**: 0-100的整数，表示百分比（如10表示10%）
  - 暴击时攻击力翻倍
- **攻击速度 (ATK Speed)**: 多少回合可以攻击一次
- **重量 (Weight)**: 占用装甲的承重量

#### 装甲属性
- **血量上限 (Max HP)**: 提供的生命值
- **完美闪避率 (Dodge Rate)**: 0-100的整数，表示百分比（如15表示15%）
- **总承重量 (Capacity)**: 可以携带的武器总重量

### 2. 装备规则

#### 承重系统
- 每次只能装备**1个装甲**和**多个武器**
- 武器总重量不能超过装甲的承重量
- **重要**：当武器总重量 > 装甲承重量的60%时，闪避率强制归零！

#### 示例
```
装甲：皮革背心
- 承重量：15
- 闪避率：10%

装备武器：
- 制式步枪 (重量3) + 等离子光剑 (重量5) = 总重8
- 8 < 15 ✓ 可以装备
- 8 < 15 * 0.6 (9) ✓ 闪避率保持10%

如果再装备传奇狙击炮 (重量8)：
- 总重16 > 15 ✗ 超重，无法装备

如果装备到总重10：
- 10 > 15 * 0.6 (9) ✗ 闪避率归零！
```

### 3. 稀有度系统

装备分为4个稀有度等级，用不同颜色显示：

| 稀有度 | 颜色 | 说明 |
|--------|------|------|
| 损坏 (BROKEN) | 白色 | 低级装备 |
| 普通 (STANDARD) | 绿色 | 标准装备 |
| 军用 (MILITARY) | 红色 | 高级装备 |
| 传奇 (LEGENDARY) | 黄色 | 顶级装备 |

### 4. 存档系统

- **3个存档槽位**：支持多个角色
- **自动保存**：退出时自动保存
- **数据分离**：
  - `gamedata.json` - 所有装备和怪物的模板数据
  - `save_slot_X.json` - 玩家的进度数据

### 5. 主菜单功能

```
[1] 查看机库 (Inventory)
    - 查看所有拥有的装备
    - 显示装备的详细属性
    - 带颜色的稀有度标识

[2] 装备管理 (Equip)
    - 装备/卸下装甲
    - 装备/卸下武器
    - 实时显示承重状态
    - 超重警告提示

[0] 退出系统 (Exit)
    - 自动保存进度
```

## 📊 装备数据

### 初始装备（新手礼包）

#### 装甲
1. **皮革背心** (普通)
   - 血量：400
   - 闪避率：10%
   - 承重：15

2. **破损铁甲** (损坏)
   - 血量：200
   - 闪避率：5%
   - 承重：10

#### 武器
1. **制式步枪** (普通)
   - 攻击：50
   - 暴击率：10%
   - 速度：2回合/次
   - 重量：3

2. **等离子光剑** (军用)
   - 攻击：120
   - 暴击率：25%
   - 速度：1回合/次
   - 重量：5

3. **生锈的铁管** (损坏)
   - 攻击：15
   - 暴击率：5%
   - 速度：3回合/次
   - 重量：2

### 可获得装备（gamedata.json中）

#### 传奇装备
- **传奇狙击炮** (传奇武器)
  - 攻击：300
  - 暴击率：50%
  - 速度：5回合/次
  - 重量：8

- **泰坦机甲** (传奇装甲)
  - 血量：1000
  - 闪避率：25%
  - 承重：20

## 🎯 游戏策略

### 装备搭配建议

1. **速攻流**
   - 装甲：反应堆外壳（承重15）
   - 武器：等离子光剑 + 制式步枪
   - 特点：高攻击频率，保持闪避率

2. **重火力流**
   - 装甲：泰坦机甲（承重20）
   - 武器：传奇狙击炮 + 等离子光剑
   - 特点：超高伤害，但可能失去闪避

3. **平衡流**
   - 装甲：皮革背心（承重15）
   - 武器：制式步枪 + 生锈的铁管 + 制式步枪
   - 特点：保持60%以下承重，维持闪避率

## 🔧 技术细节

### 编译命令
```bash
g++ -std=c++17 main.cpp GameCore.cpp -o game.exe
```

### 文件结构
```
├── main.cpp           # 主程序和UI
├── GameCore.h         # 核心类定义
├── GameCore.cpp       # 核心类实现
├── DataLoader.h       # JSON数据加载
├── SaveManager.h      # 存档管理
├── json.hpp           # JSON库
├── gamedata.json      # 游戏数据库
├── enemy.json         # 怪物数据
└── save_slot_X.json   # 玩家存档
```

### 数据存储格式

#### 概率值存储
- 所有概率值以整数存储（0-100）
- 10 表示 10%
- 25 表示 25%
- 避免使用浮点数

#### JSON示例
```json
{
  "id": 101,
  "type": "weapon",
  "name": "制式步枪",
  "rarity": "STANDARD",
  "faction": "共和国",
  "atk": 50,
  "crit_rate": 10,
  "atk_speed": 2,
  "weight": 3
}
```

## 🐛 已知特性

1. 卸下装甲时会自动卸下所有武器（设计如此）
2. 颜色显示需要终端支持ANSI颜色代码
3. Windows下使用UTF-8编码（chcp 65001）

## 📝 更新日志

### Ver 0.2 (当前版本)
- ✅ 完整的装备系统
- ✅ 承重和闪避率机制
- ✅ 稀有度颜色显示
- ✅ 装备管理界面
- ✅ 隐藏了合成和怪物图鉴（待开发）

### Ver 0.1
- 基础存档系统
- 简单的背包查看
- JSON数据加载

