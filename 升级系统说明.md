# 钢之魂 Ver 0.3 - 升级系统说明

## ✨ 新功能：装备升级系统

### 基本规则

#### 等级系统
- **初始等级**: 1级
- **最高等级**: 3级
- **升级次数**: 每件装备可升级2次（1→2→3）

#### 升级消耗
升级消耗 = **10 × 稀有度等级**

| 稀有度 | 稀有度等级 | 升级消耗 |
|--------|-----------|---------|
| 损坏 (BROKEN) | 1 | 10 EXP |
| 普通 (STANDARD) | 2 | 20 EXP |
| 军用 (MILITARY) | 3 | 30 EXP |
| 传奇 (LEGENDARY) | 4 | 40 EXP |

### 属性加成

#### 武器升级
每升1级，以下属性相对于1级时增加20%：
- ✅ **攻击力** +20%
- ✅ **暴击率** +20% (上限100%)
- ✅ **攻击速度** -20% (数值越小越快，最低1回合)
- ❌ **重量** 不变

#### 装甲升级
每升1级，以下属性相对于1级时增加20%：
- ✅ **血量上限** +20%
- ✅ **闪避率** +20% (上限100%)
- ✅ **承重量** +20%

### 计算公式

#### 武器属性计算
```
实际攻击力 = 基础攻击力 × (1 + 0.2 × (等级 - 1))
实际暴击率 = min(基础暴击率 × (1 + 0.2 × (等级 - 1)), 100)
实际攻击速度 = max(基础攻击速度 / (1 + 0.2 × (等级 - 1)), 1)
```

#### 装甲属性计算
```
实际血量 = 基础血量 × (1 + 0.2 × (等级 - 1))
实际闪避率 = min(基础闪避率 × (1 + 0.2 × (等级 - 1)), 100)
实际承重 = 基础承重 × (1 + 0.2 × (等级 - 1))
```

### 升级示例

#### 示例1：制式步枪（普通）

| 等级 | 攻击力 | 暴击率 | 攻击速度 | 升级消耗 |
|------|--------|--------|----------|---------|
| Lv.1 | 50 | 10% | 2回合 | - |
| Lv.2 | 60 | 12% | 1回合 | 20 EXP |
| Lv.3 | 70 | 14% | 1回合 | 20 EXP |

**总消耗**: 40 EXP  
**总提升**: 攻击+40%，暴击率+40%，速度快1倍

#### 示例2：皮革背心（普通）

| 等级 | 血量 | 闪避率 | 承重 | 升级消耗 |
|------|------|--------|------|---------|
| Lv.1 | 400 | 10% | 15 | - |
| Lv.2 | 480 | 12% | 18 | 20 EXP |
| Lv.3 | 560 | 14% | 21 | 20 EXP |

**总消耗**: 40 EXP  
**总提升**: 血量+40%，闪避率+40%，承重+40%

#### 示例3：传奇狙击炮（传奇）

| 等级 | 攻击力 | 暴击率 | 攻击速度 | 升级消耗 |
|------|--------|--------|----------|---------|
| Lv.1 | 300 | 50% | 5回合 | - |
| Lv.2 | 360 | 60% | 4回合 | 40 EXP |
| Lv.3 | 420 | 70% | 3回合 | 40 EXP |

**总消耗**: 80 EXP  
**总提升**: 攻击+40%，暴击率+40%，速度提升40%

## 🎮 使用方法

### 获取 EXP
- 通过战斗击败怪物获得（战斗系统待开发）
- 测试功能：主菜单选择 `[9] 测试：获得100 EXP`

### 升级装备
1. 主菜单选择 `[3] 武器升级 (Upgrade)`
2. 查看可升级的武器和装甲列表
3. 每件装备显示：
   - 当前等级和最高等级
   - 升级所需 EXP
   - 当前属性
   - 升级后属性预览
4. 输入装备编号进行升级
5. 确认消耗 EXP 并升级

### 界面说明
```
=== 装备升级系统 ===
当前 EXP: 200

【武器】
[0] 制式步枪 | 等级: 1/3 | 升级消耗: 20 EXP [可升级]
    当前: 攻击75 暴击10%  速度2
    升级后: 攻击90 暴击12%  速度1

【装甲】
[W1] 皮革背心 | 等级: 1/3 | 升级消耗: 20 EXP [可升级]
    当前: 血量400 闪避10%  承重15
    升级后: 血量480 闪避12%  承重18

请选择要升级的装备编号 (输入-1取消):
```

## 💾 存档系统

### 存档内容
- 玩家名字
- **当前 EXP**
- 每件装备的：
  - 装备ID
  - **当前等级** (1-3)
  - 稀有度

### 存档格式示例
```json
{
    "player_name": "玩家名",
    "exp": 260,
    "inventory": [
        {
            "tid": 101,
            "lv": 3,
            "rar": 1
        }
    ]
}
```

## 🎯 策略建议

### 升级优先级

#### 1. 优先升级主力武器
- 选择最常用的武器优先升级到满级
- 攻击力和暴击率提升显著

#### 2. 平衡发展
- 不要只升级武器，装甲也很重要
- 装甲升级后承重增加，可以装备更多武器

#### 3. 考虑稀有度
- 传奇装备升级消耗高，但基础属性强
- 普通装备升级便宜，性价比高

#### 4. EXP 管理
- 保留一定 EXP 以备不时之需
- 不要一次性把所有 EXP 用完

### 装备组合建议

#### 经济型（低 EXP）
- 皮革背心 Lv.3 (40 EXP)
- 制式步枪 Lv.3 (40 EXP)
- **总计**: 80 EXP

#### 豪华型（高 EXP）
- 泰坦机甲 Lv.3 (80 EXP)
- 传奇狙击炮 Lv.3 (80 EXP)
- **总计**: 160 EXP

## 📊 属性上限

### 概率上限
- **暴击率**: 最高 100%
- **闪避率**: 最高 100%

### 速度下限
- **攻击速度**: 最快 1回合/次

### 重量
- **武器重量**: 不受等级影响，保持不变

## 🔄 版本更新

### Ver 0.3 新增
- ✅ 完整的升级系统
- ✅ EXP 经验值系统
- ✅ 武器升级（攻击力、暴击率、攻击速度）
- ✅ 装甲升级（血量、闪避率、承重量）
- ✅ 升级预览功能
- ✅ EXP 存档保存
- ✅ 等级存档保存
- ✅ 测试功能（获得 EXP）

### 待开发
- ⏳ 战斗系统（获得 EXP 的正式途径）
- ⏳ 更多装备
- ⏳ 装备合成系统

