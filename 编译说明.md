# 钢之魂：核心重构 Ver 0.2 - 编译说明

## 编译命令

使用以下命令编译项目：

```bash
g++ -std=c++17 main.cpp GameCore.cpp -o game.exe
```

## 运行程序

编译成功后，直接运行：

```bash
.\game.exe
```

## 快速开始

1. 编译项目
2. 运行游戏
3. 选择存档槽位（1-3）
4. 新玩家输入名字，会自动获得新手礼包
5. 使用装备管理功能装备武器和装甲

## 项目结构

```
2025.12.28/
├── main.cpp           - 主程序入口和游戏循环
├── GameCore.h         - 核心类定义（Equipment、Weapon、Armor）
├── GameCore.cpp       - 核心类实现
├── DataLoader.h       - 数据加载器（JSON解析）
├── SaveManager.h      - 存档管理器
├── json.hpp           - JSON库（nlohmann/json）
├── gamedata.json      - 游戏数据库
├── enemy.json         - 怪物数据
├── gear.json          - 装备数据
├── game.exe           - 编译后的可执行文件
└── saves/             - 存档文件夹 ⭐
    ├── save_slot_1.json
    ├── save_slot_2.json
    └── save_slot_3.json
```

## 版本更新

### Ver 0.2 - 装备系统重构
1. **武器系统** - 添加暴击率、攻击速度、重量属性
2. **装甲系统** - 添加血量上限、闪避率、承重量属性
3. **装备管理** - 完整的装备/卸下武器和装甲功能
4. **承重机制** - 武器重量超过60%承重时闪避率归零
5. **颜色显示** - 根据稀有度显示不同颜色（白/绿/红/黄）
6. **数据类型** - 概率值改为整数存储（10表示10%）
7. **新手礼包** - 新玩家获得5件初始装备
8. **存档文件夹** - 所有存档保存在 `saves/` 文件夹
9. **自动初始化** - 自动创建3个存档槽位
10. **存档信息显示** - 启动时显示所有存档的玩家名、EXP和装备数

### Ver 0.1 - 基础系统
1. **Weapon::clone** - 修复了 `id` 字段名称错误（应为 `tid`）
2. **Armor::clone** - 修复了构造函数参数缺少 `id` 的问题
3. **DataLoader** - 为 Weapon 和 Armor 构造函数添加了 `id` 参数
4. **Equipment** - 添加了 `getRarity()` 方法用于存档系统
5. **GameCore.cpp** - 移除了重复的构造函数定义
6. **main.cpp** - 添加了 `monsters` 变量声明
7. **存档加载逻辑** - 修复了每次加载存档都要求输入名字的问题
8. **SaveManager** - 添加了 `getItemTemplate()` 公共方法用于访问装备库

## 功能特性

### 核心系统
- ✅ **存档系统**（3个存档槽位）
  - 自动保存玩家名字和装备
  - 加载存档时自动恢复进度
  - 新玩家自动获得5件初始装备

- ✅ **装备系统**
  - 武器：攻击力、暴击率、攻击速度、重量
  - 装甲：血量上限、闪避率、承重量
  - 承重机制：超过60%闪避率归零
  - 稀有度颜色显示

- ✅ **装备管理**
  - 装备/卸下装甲
  - 装备/卸下武器（支持多件）
  - 实时承重状态显示
  - 超重警告提示

- ✅ **数据持久化**
  - `gamedata.json` - 所有装备和怪物的模板数据
  - `save_slot_X.json` - 玩家存档数据

### 待开发功能
- ⏳ 装备合成系统（已隐藏）
- ⏳ 怪物图鉴（已隐藏）
- ⏳ 战斗系统

## 注意事项

- 确保所有 JSON 文件（gamedata.json、enemy.json、gear.json）与可执行文件在同一目录
- 程序使用 UTF-8 编码，支持中文显示
- 存档文件会自动保存为 `save_slot_X.json` 格式

